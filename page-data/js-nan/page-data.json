{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/js-nan/","result":{"data":{"site":{"siteMetadata":{"title":"emewjin.log","siteUrl":"https://emewjin.github.io"}},"markdownRemark":{"id":"a14fa7ff-8d13-5839-8e1a-3b51ad334b04","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%ED%95%AD%EC%83%81-%EA%B0%99%EC%9D%80-%EA%B2%83%EC%9D%84-%EB%B0%98%ED%99%98%ED%95%98%EB%8A%94-%EC%88%AB%EC%9E%90\">항상 같은 것을 반환하는 숫자</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EC%97%90%EC%84%9C-%ED%95%98%EB%93%9C%EC%9B%A8%EC%96%B4-%EC%88%98%EC%A4%80%EA%B9%8C%EC%A7%80\">자바스크립트에서 하드웨어 수준까지</a></p>\n</li>\n<li>\n<p><a href=\"#nan--nan\">NaN !== NaN</a></p>\n</li>\n<li>\n<p><a href=\"#typeof-nan--number\">typeof NaN === “number”</a></p>\n</li>\n<li>\n<p><a href=\"#ieee-754-1985-%EC%9D%B4%EC%A7%84-%EB%B6%80%EB%8F%99-%EC%86%8C%EC%88%98%EC%A0%90-%EC%82%B0%EC%88%A0-%ED%91%9C%EC%A4%80\">IEEE 754-1985: 이진 부동 소수점 산술 표준</a></p>\n<ul>\n<li><a href=\"#%EC%A3%BC%EC%9A%94-%EA%B2%B0%EC%A0%95-%EC%82%AC%ED%95%AD\">주요 결정 사항</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#nan%EC%9D%80-%EC%88%AB%EC%9E%90%EC%9E%85%EB%8B%88%EB%8B%A4-%ED%95%98%EC%A7%80%EB%A7%8C-%EC%96%B4%EB%96%A4-%EC%A2%85%EB%A5%98%EC%9D%BC%EA%B9%8C%EC%9A%94\">NaN은 숫자입니다, 하지만 어떤 종류일까요?</a></p>\n</li>\n<li>\n<p><a href=\"#1994%EB%85%84-%ED%8E%9C%ED%8B%B0%EC%97%84-fdiv-%EB%B2%84%EA%B7%B8\">1994년: 펜티엄 FDIV 버그</a></p>\n</li>\n<li>\n<p><a href=\"#%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%A8%B8%EC%9D%98-%EA%B5%AC%EC%9B%90%EC%9E%90-nan\">프로그래머의 구원자, NaN</a></p>\n</li>\n<li>\n<p><a href=\"#nan-not-a-number\">NaN (Not a Number)</a></p>\n<ul>\n<li><a href=\"#%EC%98%B5%EC%85%98-a-division-error--%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%A8-%EC%B6%A9%EB%8F%8C-ieee-754-%EC%9D%B4%EC%A0%84-%EB%B0%A9%EC%8B%9D\">옵션 A: Division Error → 프로그램 충돌 (IEEE 754 이전 방식)</a></li>\n<li><a href=\"#%EC%98%B5%EC%85%98-b-%EC%98%88%EB%A5%BC-%EB%93%A4%EC%96%B4-0%EC%9D%84-%EB%B0%98%ED%99%98\">옵션 B: 예를 들어 0을 반환</a></li>\n<li><a href=\"#%EC%98%B5%EC%85%98-c-null-%EB%98%90%EB%8A%94-%ED%8A%B9%EB%B3%84%ED%95%9C-%EC%98%A4%EB%A5%98-%EC%BD%94%EB%93%9C-%EB%B0%98%ED%99%98\">옵션 C: <code class=\"language-text\">null</code> 또는 특별한 오류 코드 반환</a></li>\n<li><a href=\"#%EC%98%B5%EC%85%98-d-%ED%8A%B9%EB%B3%84%ED%95%9C-%EA%B0%92-nan-%EB%B0%98%ED%99%98-ieee-754%EA%B0%80-%EC%B1%84%ED%83%9D\">옵션 D: 특별한 값 <code class=\"language-text\">NaN</code> 반환 (IEEE 754가 채택)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#nan%EC%9D%B4-%EC%97%86%EC%97%88%EB%8B%A4%EB%A9%B4-%EC%96%B4%EB%95%A0%EC%9D%84%EA%B9%8C%EC%9A%94\"><code class=\"language-text\">NaN</code>이 없었다면 어땠을까요?</a></p>\n</li>\n<li>\n<p><a href=\"#nan-%EB%8D%95%EB%B6%84%EC%97%90-%EB%AC%B4%EC%97%87%EC%9D%84-%EC%96%BB%EC%97%88%EC%9D%84%EA%B9%8C%EC%9A%94\"><code class=\"language-text\">NaN</code> 덕분에 무엇을 얻었을까요?</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%9A%94%EC%95%BD\">요약</a></p>\n</li>\n<li>\n<p><a href=\"#references\">References</a></p>\n</li>\n</ul>","excerpt":"원문: Why NaN !== NaN in JavaScript (and the IEEE 754 story behind it…","html":"<blockquote>\n<p>원문: <a href=\"https://pzarycki.com/en/posts/js-nan/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Why NaN !== NaN in JavaScript (and the IEEE 754 story behind it)</a></p>\n</blockquote>\n<p><img src=\"https://pzarycki.com/en/posts/js-nan/nan.en.png\" alt=\"\"></p>\n<h2 id=\"항상-같은-것을-반환하는-숫자\" style=\"position:relative;\"><a href=\"#%ED%95%AD%EC%83%81-%EA%B0%99%EC%9D%80-%EA%B2%83%EC%9D%84-%EB%B0%98%ED%99%98%ED%95%98%EB%8A%94-%EC%88%AB%EC%9E%90\" aria-label=\"항상 같은 것을 반환하는 숫자 permalink\" class=\"heading-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>항상 같은 것을 반환하는 숫자</h2>\n<p>오늘 우리는 자바스크립트에서 <code class=\"language-text\">number</code> 타입으로 식별되는 <code class=\"language-text\">NaN</code>에 대해 살펴보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">></span> <span class=\"token keyword\">typeof</span> <span class=\"token number\">NaN</span>\n<span class=\"token string\">'number'</span></code></pre></div>\n<p>응답으로 <code class=\"language-text\">number</code> 타입을 받습니다.\n무엇인가 숫자이려면, 논리적으로 수학 연산을 수행할 수 있어야 합니다.\n그러니 <code class=\"language-text\">NaN</code>에 다른 무언가를 더하거나 최댓값, 최솟값을 확인해 보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">></span> <span class=\"token number\">NaN</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n<span class=\"token number\">NaN</span>\n<span class=\"token operator\">></span> <span class=\"token number\">NaN</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span>\n<span class=\"token number\">NaN</span>\n<span class=\"token operator\">></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token number\">NaN</span><span class=\"token punctuation\">)</span>\n<span class=\"token number\">NaN</span>\n<span class=\"token operator\">></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">min</span><span class=\"token punctuation\">(</span><span class=\"token number\">NaN</span><span class=\"token punctuation\">)</span>\n<span class=\"token number\">NaN</span></code></pre></div>\n<p>보시다시피, 덧셈, 뺄셈, 최댓값/최솟값 확인 후에도 항상 같은 결과를 얻습니다.\n그렇다면 왜 이런 값이 필요한 걸까요?\n이를 설명하기 위해, Firefox나 V8 내부를 들여다보며 <code class=\"language-text\">NaN</code>의 사용처와 구현을 찾아보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\">// Firefox</span>\n<span class=\"token keyword\">bool</span> <span class=\"token function\">isNaN</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token function\">isDouble</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> std<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">isnan</span><span class=\"token punctuation\">(</span><span class=\"token function\">toDouble</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// V8</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">IsMinusZero</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token function\">has_minus_zero</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>std<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">isnan</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token function\">has_nan</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>예시 브라우저의 코드를 보면, <code class=\"language-text\">NaN</code>을 확인하기 위해 표준 라이브러리의 <code class=\"language-text\">std::isnan</code> 메서드가 사용됩니다. 이는 <code class=\"language-text\">NaN</code>이 자바스크립트와 무관하게 등장했다는 것을 시사할 수 있습니다.\n그리고 실제로 역사를 거슬러 올라가 보면, <code class=\"language-text\">NaN</code>의 최초 표준화는 1985년에 등장했으며 <a href=\"https://en.wikipedia.org/wiki/IEEE_754\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">IEEE 754</a>라는 번호가 부여되었습니다.</p>\n<h2 id=\"자바스크립트에서-하드웨어-수준까지\" style=\"position:relative;\"><a href=\"#%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EC%97%90%EC%84%9C-%ED%95%98%EB%93%9C%EC%9B%A8%EC%96%B4-%EC%88%98%EC%A4%80%EA%B9%8C%EC%A7%80\" aria-label=\"자바스크립트에서 하드웨어 수준까지 permalink\" class=\"heading-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>자바스크립트에서 하드웨어 수준까지</h2>\n<p>이 지식을 바탕으로, 브라우저 코드에서 찾은 내용을 기반으로 <code class=\"language-text\">NaN</code>이 어떻게 동작하는지 확인하는 간단한 C 프로그램을 작성해 보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">></span> <span class=\"token number\">NaN</span> <span class=\"token operator\">!==</span> <span class=\"token number\">NaN</span>\n<span class=\"token boolean\">true</span>\n<span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">/</span> <span class=\"token number\">0</span>\n<span class=\"token number\">NaN</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;math.h></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdint.h></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">double</span> x <span class=\"token operator\">=</span> <span class=\"token number\">0.0</span> <span class=\"token operator\">/</span> <span class=\"token number\">0.0</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">!=</span> x<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"NaN is not the same\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isnan</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x is NaN\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token class-name\">uint64_t</span> bits <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>x<span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"NaN hex: 0x%016lx\\n\"</span><span class=\"token punctuation\">,</span> bits<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>결과는 자바스크립트에서와 동일합니다!</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">NaN is not the same\nx is NaN\nNaN hex: 0xfff8000000000000</code></pre></div>\n<p>우리는 <code class=\"language-text\">NaN</code>이 다른 프로그래밍 언어에서도 발견된다는 것을 이미 알고 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">#Python</span>\n\n<span class=\"token keyword\">import</span> math\n\nnan <span class=\"token operator\">=</span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span><span class=\"token string\">'nan'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>nan <span class=\"token operator\">!=</span> nan<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># True</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>nan <span class=\"token operator\">==</span> nan<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># False</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>math<span class=\"token punctuation\">.</span>isnan<span class=\"token punctuation\">(</span>nan<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># True</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"c++\"><pre class=\"language-c++\"><code class=\"language-c++\">//C++\n\n#include &lt;iostream&gt;\n#include &lt;cmath&gt;\n\nint main() {\n    double nan = NAN;\n    std::cout &lt;&lt; (nan != nan) &lt;&lt; std::endl;  // 1 (true)\n    std::cout &lt;&lt; (nan == nan) &lt;&lt; std::endl;  // 0 (false)\n    std::cout &lt;&lt; std::isnan(nan) &lt;&lt; std::endl;  // 1 (true, proper way)\n    return 0;\n}</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token comment\">//Rust</span>\n\n<span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> nan <span class=\"token operator\">=</span> <span class=\"token keyword\">f64</span><span class=\"token punctuation\">::</span><span class=\"token constant\">NAN</span><span class=\"token punctuation\">;</span>\n    <span class=\"token macro property\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"{}\"</span><span class=\"token punctuation\">,</span> nan <span class=\"token operator\">!=</span> nan<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// true</span>\n    <span class=\"token macro property\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"{}\"</span><span class=\"token punctuation\">,</span> nan <span class=\"token operator\">==</span> nan<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// false</span>\n    <span class=\"token macro property\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"{}\"</span><span class=\"token punctuation\">,</span> nan<span class=\"token punctuation\">.</span><span class=\"token function\">is_nan</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// true (proper way)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>하지만 여전히 그것이 무엇을 위한 것인지는 모릅니다.</p>\n<p>여전히 이유를 알 수 없으니, 우리의 간단한 프로그램으로 어셈블리 코드를 생성해 보겠습니다 (프롤로그와 스택 프레임 초기화는 건너뛰겠습니다).</p>\n<div class=\"gatsby-highlight\" data-language=\"asm\"><pre class=\"language-asm\"><code class=\"language-asm\"># =====================================\n#     double x = 0.0 / 0.0;\n# =====================================\n\tpxor\txmm0, xmm0                 # xmm0 = 0.0\n\tdivsd\txmm0, xmm0                 # xmm0 = 0.0 / 0.0 = NaN\n\tmovsd\tQWORD PTR -8[rbp], xmm0    # x = NaN\n\n# =====================================\n#     if (x != x) {\n# =====================================\n\tmovsd\txmm0, QWORD PTR -8[rbp]    # xmm0 = x\n\tucomisd\txmm0, QWORD PTR -8[rbp]    # compare x with x (sets PF=1 for NaN)\n\tjnp\t.L2                            # skip if NOT NaN (PF=0)\n\t# NaN detected - code here\n.L2:\n\n# =====================================\n#     if (isnan(x)) {\n# =====================================\n\tmovsd\txmm0, QWORD PTR -8[rbp]    # xmm0 = x\n\tucomisd\txmm0, QWORD PTR -8[rbp]    # compare x with x (sets PF=1 for NaN)\n\tjnp\t.L3                            # skip if NOT NaN (PF=0)\n\t# NaN detected - code here\n.L3:</code></pre></div>\n<p>어셈블리를 접해보지 않은 분들을 위해 설명하자면, <code class=\"language-text\">xmm0</code> 레지스터는 부동소수점 연산을 수행하는 레지스터입니다. 논리적으로 생각해보면, 우리는 숫자 연산을 수행하고 싶고, CPU는 숫자를 처리하니까, 이런 목적으로 특별히 설계된 레지스터에서 작업하는 게 가장 빠를 수밖에 없겠죠!</p>\n<p>또한 <code class=\"language-text\">NaN</code>을 감지했을 때 플래그를 설정하는 <code class=\"language-text\">ucomisd</code> 명령어도 볼 수 있습니다.</p>\n<p>여기서 어떤 결론을 내릴 수 있을까요? <code class=\"language-text\">NaN</code>은 자바스크립트 추상화 수준이 아닌 하드웨어 수준에서 구현된다는 것입니다.\n그러니 불필요한 추상화를 피하기 위해 어셈블리어로 프로그램을 다시 작성하고, 그 실행 결과를 살펴보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdint.h></span></span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">double</span> x<span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">uint64_t</span> bits<span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">__asm__</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token comment\">// double x = 0.0 / 0.0;</span>\n        <span class=\"token string\">\"pxor   xmm0, xmm0\\n\\t\"</span>         <span class=\"token comment\">// xmm0 = 0.0</span>\n        <span class=\"token string\">\"divsd  xmm0, xmm0\\n\\t\"</span>         <span class=\"token comment\">// xmm0 = 0.0 / 0.0 = NaN</span>\n\n        <span class=\"token comment\">// Save results</span>\n        <span class=\"token string\">\"movsd  %0, xmm0\\n\\t\"</span>           <span class=\"token comment\">// x = NaN</span>\n        <span class=\"token string\">\"movq   %1, xmm0\\n\\t\"</span>           <span class=\"token comment\">// bits = *(uint64_t*)&amp;x</span>\n\n        <span class=\"token operator\">:</span> <span class=\"token string\">\"=m\"</span> <span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"=r\"</span> <span class=\"token punctuation\">(</span>bits<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">:</span>\n        <span class=\"token operator\">:</span> <span class=\"token string\">\"xmm0\"</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">int</span> is_not_equal<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">__asm__</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token comment\">// if (x != x)</span>\n        <span class=\"token string\">\"movsd  xmm0, %1\\n\\t\"</span>           <span class=\"token comment\">// xmm0 = x</span>\n        <span class=\"token string\">\"ucomisd xmm0, %1\\n\\t\"</span>          <span class=\"token comment\">// compare x with x → PF=1 for NaN</span>\n        <span class=\"token string\">\"setp   al\\n\\t\"</span>                 <span class=\"token comment\">// al = (x != x)</span>\n        <span class=\"token string\">\"movzx  %0, al\\n\\t\"</span>             <span class=\"token comment\">// is_not_equal = al</span>\n\n        <span class=\"token operator\">:</span> <span class=\"token string\">\"=r\"</span> <span class=\"token punctuation\">(</span>is_not_equal<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">:</span> <span class=\"token string\">\"m\"</span> <span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">:</span> <span class=\"token string\">\"xmm0\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"al\"</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>is_not_equal<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>                 <span class=\"token comment\">// if (x != x)</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"NaN is not the same\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">int</span> is_nan_result<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">__asm__</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token comment\">// if (isnan(x))</span>\n        <span class=\"token string\">\"movsd  xmm0, %1\\n\\t\"</span>           <span class=\"token comment\">// xmm0 = x</span>\n        <span class=\"token string\">\"ucomisd xmm0, %1\\n\\t\"</span>          <span class=\"token comment\">// compare x with x → PF=1 for NaN</span>\n        <span class=\"token string\">\"setp   al\\n\\t\"</span>                 <span class=\"token comment\">// al = isnan(x)</span>\n        <span class=\"token string\">\"movzx  %0, al\\n\\t\"</span>             <span class=\"token comment\">// is_nan_result = al</span>\n\n        <span class=\"token operator\">:</span> <span class=\"token string\">\"=r\"</span> <span class=\"token punctuation\">(</span>is_nan_result<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">:</span> <span class=\"token string\">\"m\"</span> <span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">:</span> <span class=\"token string\">\"xmm0\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"al\"</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>is_nan_result<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>                <span class=\"token comment\">// if (isnan(x))</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"x is NaN\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"NaN hex: 0x%016lx\\n\"</span><span class=\"token punctuation\">,</span> bits<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>결과는 어떨까요?</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">NaN is not the same\nx is NaN\nNaN hex: 0xfff8000000000000</code></pre></div>\n<p>프로그램의 출력은 고수준 언어인 C와 동일합니다.</p>\n<p>우리는 <code class=\"language-text\">NaN</code>이 네이티브로 구현되어 있음을 이미 알고 있으니, <code class=\"language-text\">ucomisd</code> 명령어를 살펴보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"asm\"><pre class=\"language-asm\"><code class=\"language-asm\">&quot;ucomisd xmm0, %1\\n\\t&quot;          // compare x with x → PF=1 for NaN</code></pre></div>\n<p><code class=\"language-text\">ucomisd</code>는 <strong>U</strong>nordered <strong>Compa</strong>re <strong>S</strong>calar <strong>D</strong>ouble-precision floating-point(순서 없는 스칼라 배정밀도 부동 소수점 비교)의 약자입니다. 이 멋진 명령어는 x86 아키텍처 프로그래머들의 시간과 신경을 절약해 주었습니다. 왜냐하면 CPU 수준에서 이미 숫자 연산 결과가 올바른지 아닌지를 확인해 주기 때문입니다.</p>\n<h2 id=\"nan--nan\" style=\"position:relative;\"><a href=\"#nan--nan\" aria-label=\"nan  nan permalink\" class=\"heading-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>NaN !== NaN</h2>\n<p>주된 이유는 프로그래밍 언어에 <code class=\"language-text\">isnan()</code> 함수가 아직 존재하지 않던 시절, 프로그래머들에게 <code class=\"language-text\">x != x</code> 테스트를 사용해 <code class=\"language-text\">NaN</code>을 감지할 방법을 제공하기 위함이었습니다.</p>\n<p>논리적인 관점에서 볼 때, 이는 매우 타당합니다. 왜냐하면 ‘값이 아님’은 ‘값이 아님’과 같을 수 없기 때문입니다.</p>\n<p>이것은 버그가 아니라 <strong>의도된 설계</strong>입니다.</p>\n<h2 id=\"typeof-nan--number\" style=\"position:relative;\"><a href=\"#typeof-nan--number\" aria-label=\"typeof nan  number permalink\" class=\"heading-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>typeof NaN === “number”</h2>\n<p><code class=\"language-text\">NaN</code>은 별도의 타입이 아니라 숫자 시스템(<code class=\"language-text\">IEEE 754</code>)의 일부입니다. 이는 수학적 연산 오류를 알리는 특별한 숫자 값입니다.</p>\n<h2 id=\"ieee-754-1985-이진-부동-소수점-산술-표준\" style=\"position:relative;\"><a href=\"#ieee-754-1985-%EC%9D%B4%EC%A7%84-%EB%B6%80%EB%8F%99-%EC%86%8C%EC%88%98%EC%A0%90-%EC%82%B0%EC%88%A0-%ED%91%9C%EC%A4%80\" aria-label=\"ieee 754 1985 이진 부동 소수점 산술 표준 permalink\" class=\"heading-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IEEE 754-1985: 이진 부동 소수점 산술 표준</h2>\n<ul>\n<li>발표: 1985년</li>\n<li>저자: 윌리엄 카한(UC 버클리) + IEEE 위원회</li>\n<li>정의: NaN, 무한(Infinity), 비정규화된 수(denormalized numbers), 반올림 모드</li>\n</ul>\n<h3 id=\"주요-결정-사항\" style=\"position:relative;\"><a href=\"#%EC%A3%BC%EC%9A%94-%EA%B2%B0%EC%A0%95-%EC%82%AC%ED%95%AD\" aria-label=\"주요 결정 사항 permalink\" class=\"heading-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>주요 결정 사항</h3>\n<ul>\n<li><code class=\"language-text\">NaN !== NaN</code> (동등 비교 시 항상 <code class=\"language-text\">false</code>)</li>\n<li>지수(Exponent) = <code class=\"language-text\">0x7FF</code>, 가수(mantissa) ≠ 0</li>\n<li><strong>Quiet NaN</strong> (qNaN) - 예외를 알리지 않고 연산을 통해 전파됨</li>\n<li><strong>Signaling NaN</strong> (sNaN) - 연산에 처음 사용될 때 예외를 생성함</li>\n<li><code class=\"language-text\">NaN</code> 전파 (<code class=\"language-text\">NaN</code>과의 모든 연산 → <code class=\"language-text\">NaN</code>)</li>\n</ul>\n<h2 id=\"nan은-숫자입니다-하지만-어떤-종류일까요\" style=\"position:relative;\"><a href=\"#nan%EC%9D%80-%EC%88%AB%EC%9E%90%EC%9E%85%EB%8B%88%EB%8B%A4-%ED%95%98%EC%A7%80%EB%A7%8C-%EC%96%B4%EB%96%A4-%EC%A2%85%EB%A5%98%EC%9D%BC%EA%B9%8C%EC%9A%94\" aria-label=\"nan은 숫자입니다 하지만 어떤 종류일까요 permalink\" class=\"heading-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>NaN은 숫자입니다, 하지만 어떤 종류일까요?</h2>\n<p><code class=\"language-text\">0/0</code>을 나누는 데 왜 부동 소수점 숫자 레지스터가 사용되는지 궁금할 수도 있습니다.</p>\n<p>자바스크립트에서 <code class=\"language-text\">number</code> 타입 값에 대한 연산은 IEEE 754 표준에 따라 연산을 수행하기 위해 배정밀도 부동 소수점 숫자(double)로 표현됩니다.</p>\n<p>정수 연산에서 0으로 나누는 것은 명백한 오류입니다. 하지만 부동 소수점 숫자에서는 다음과 같이 정의되지 않은 결과를 초래할 수 있는 많은 경우가 있습니다.</p>\n<ul>\n<li><code class=\"language-text\">0.0 / 0.0</code> → <code class=\"language-text\">NaN</code></li>\n<li><code class=\"language-text\">∞ - ∞</code> → <code class=\"language-text\">NaN</code></li>\n<li><code class=\"language-text\">0 * ∞</code> → <code class=\"language-text\">NaN</code></li>\n<li><code class=\"language-text\">sqrt(-1)</code> → <code class=\"language-text\">NaN</code></li>\n</ul>\n<p>IEEE 754 표준이 없었을 때, 각 하드웨어 제조사는 이러한 상황을 제각기 다르게 처리했으며, 이는 엄청난 코드 이식성 문제를 야기했습니다.</p>\n<h2 id=\"1994년-펜티엄-fdiv-버그\" style=\"position:relative;\"><a href=\"#1994%EB%85%84-%ED%8E%9C%ED%8B%B0%EC%97%84-fdiv-%EB%B2%84%EA%B7%B8\" aria-label=\"1994년 펜티엄 fdiv 버그 permalink\" class=\"heading-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1994년: 펜티엄 FDIV 버그</h2>\n<p>펜티엄의 부동 소수점 나눗셈 버그 - 일부 나눗셈이 부정확한 결과를 반환했습니다. <code class=\"language-text\">NaN</code>과 관련된 문제는 아니었지만, 이는 정확한 IEEE 754 구현의 중요성을 보여주었습니다.</p>\n<p>인텔은 수백만 개의 프로세서를 교체했으며, 이로 인해 4억 7,500만 달러의 비용이 발생했습니다.</p>\n<h2 id=\"프로그래머의-구원자-nan\" style=\"position:relative;\"><a href=\"#%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%A8%B8%EC%9D%98-%EA%B5%AC%EC%9B%90%EC%9E%90-nan\" aria-label=\"프로그래머의 구원자 nan permalink\" class=\"heading-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>프로그래머의 구원자, NaN</h2>\n<p><code class=\"language-text\">NaN</code>이 하드웨어 수준에서 설정된다는 것을 배웠는데, <code class=\"language-text\">NaN</code> 이전에는 무엇이 있었을까요?</p>\n<p>IEEE 754 표준(1985년) 이전에는 각 하드웨어 제조사가 제각각의 방식을 사용했으며, 이는 보통 <code class=\"language-text\">0/0</code> 같은 연산이 프로그램 충돌 및 종료로 이어진다는 것을 의미했습니다.</p>\n<p>이로 인해 개발자들은 매우 방어적인 프로그래밍을 해야 했습니다. 비행기를 조종하고 있는데, 제어 시스템의 프로그래머가 <code class=\"language-text\">0/0</code>을 예상하지 못했다고 상상해 보세요. 해당 명령어가 CPU에서 실행되고 ‘Division Error’로 인해 프로그램 전체가 다운됩니다!</p>\n<p>인텔과 다른 제조사들은 아키텍처마다 프로그램이 다르게 동작하는 혼란에 질려버렸습니다.</p>\n<h2 id=\"nan-not-a-number\" style=\"position:relative;\"><a href=\"#nan-not-a-number\" aria-label=\"nan not a number permalink\" class=\"heading-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>NaN (Not a Number)</h2>\n<p>왜 다른 해결책 대신 특별한 값을 사용했는지 자문해 볼 수 있습니다.</p>\n<p>여러 옵션을 고려해 보겠습니다.</p>\n<h3 id=\"옵션-a-division-error--프로그램-충돌-ieee-754-이전-방식\" style=\"position:relative;\"><a href=\"#%EC%98%B5%EC%85%98-a-division-error--%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%A8-%EC%B6%A9%EB%8F%8C-ieee-754-%EC%9D%B4%EC%A0%84-%EB%B0%A9%EC%8B%9D\" aria-label=\"옵션 a division error  프로그램 충돌 ieee 754 이전 방식 permalink\" class=\"heading-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>옵션 A: Division Error → 프로그램 충돌 (IEEE 754 이전 방식)</h3>\n<ul>\n<li>예상치 못한 프로그램 종료 (비행기 예시 참고)</li>\n<li>모든 연산 전에 방어적인 프로그래밍 필요</li>\n</ul>\n<h3 id=\"옵션-b-예를-들어-0을-반환\" style=\"position:relative;\"><a href=\"#%EC%98%B5%EC%85%98-b-%EC%98%88%EB%A5%BC-%EB%93%A4%EC%96%B4-0%EC%9D%84-%EB%B0%98%ED%99%98\" aria-label=\"옵션 b 예를 들어 0을 반환 permalink\" class=\"heading-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>옵션 B: 예를 들어 0을 반환</h3>\n<ul>\n<li>수학적으로 부정확함</li>\n<li>오류를 숨김</li>\n<li>이후 계산이 잘못된 결과를 도출함</li>\n</ul>\n<h3 id=\"옵션-c-null-또는-특별한-오류-코드-반환\" style=\"position:relative;\"><a href=\"#%EC%98%B5%EC%85%98-c-null-%EB%98%90%EB%8A%94-%ED%8A%B9%EB%B3%84%ED%95%9C-%EC%98%A4%EB%A5%98-%EC%BD%94%EB%93%9C-%EB%B0%98%ED%99%98\" aria-label=\"옵션 c null 또는 특별한 오류 코드 반환 permalink\" class=\"heading-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>옵션 C: <code class=\"language-text\">null</code> 또는 특별한 오류 코드 반환</h3>\n<ul>\n<li>모든 연산 후 확인 필요</li>\n<li>수학적 계산의 연속성을 방해함</li>\n<li>결과 타입이 일관되지 않게 됨</li>\n</ul>\n<h3 id=\"옵션-d-특별한-값-nan-반환-ieee-754가-채택\" style=\"position:relative;\"><a href=\"#%EC%98%B5%EC%85%98-d-%ED%8A%B9%EB%B3%84%ED%95%9C-%EA%B0%92-nan-%EB%B0%98%ED%99%98-ieee-754%EA%B0%80-%EC%B1%84%ED%83%9D\" aria-label=\"옵션 d 특별한 값 nan 반환 ieee 754가 채택 permalink\" class=\"heading-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>옵션 D: 특별한 값 <code class=\"language-text\">NaN</code> 반환 (IEEE 754가 채택)</h3>\n<ul>\n<li>값이 계산을 통해 전파됨</li>\n<li>프로그램은 계속 실행됨</li>\n<li>계산 마지막에 결과를 확인할 수 있음</li>\n<li>타입 일관성 유지 (계속 number 타입)</li>\n</ul>\n<h2 id=\"nan이-없었다면-어땠을까요\" style=\"position:relative;\"><a href=\"#nan%EC%9D%B4-%EC%97%86%EC%97%88%EB%8B%A4%EB%A9%B4-%EC%96%B4%EB%95%A0%EC%9D%84%EA%B9%8C%EC%9A%94\" aria-label=\"nan이 없었다면 어땠을까요 permalink\" class=\"heading-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">NaN</code>이 없었다면 어땠을까요?</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">divide</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 타입을 확인합니다.</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> a <span class=\"token operator\">!==</span> <span class=\"token string\">'number'</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">typeof</span> b <span class=\"token operator\">!==</span> <span class=\"token string\">'number'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Arguments must be numbers'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// 유효하지 않은 숫자인지 확인합니다.</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">isFinite</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token operator\">!</span><span class=\"token function\">isFinite</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Arguments must be finite'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// 나누는 수를 확인합니다.</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>b <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Division by zero'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> a <span class=\"token operator\">/</span> b<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">calculate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">expression</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token function\">divide</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 무엇을 리턴해야 할까요? null? undefined? 0?</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"nan-덕분에-무엇을-얻었을까요\" style=\"position:relative;\"><a href=\"#nan-%EB%8D%95%EB%B6%84%EC%97%90-%EB%AC%B4%EC%97%87%EC%9D%84-%EC%96%BB%EC%97%88%EC%9D%84%EA%B9%8C%EC%9A%94\" aria-label=\"nan 덕분에 무엇을 얻었을까요 permalink\" class=\"heading-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">NaN</code> 덕분에 무엇을 얻었을까요?</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">divide</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> a <span class=\"token operator\">/</span> b<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 나머지는 하드웨어의 몫입니다!</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">calculate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">expression</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">divide</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token function\">calculate</span><span class=\"token punctuation\">(</span><span class=\"token string\">'10 / 0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Result:'</span><span class=\"token punctuation\">,</span> result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Infinity</span>\n\n<span class=\"token keyword\">const</span> badResult <span class=\"token operator\">=</span> <span class=\"token number\">0</span> <span class=\"token operator\">/</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Number<span class=\"token punctuation\">.</span><span class=\"token function\">isNaN</span><span class=\"token punctuation\">(</span>badResult<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Invalid calculation'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"요약\" style=\"position:relative;\"><a href=\"#%EC%9A%94%EC%95%BD\" aria-label=\"요약 permalink\" class=\"heading-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>요약</h2>\n<p><code class=\"language-text\">NaN</code>은 부동 소수점 계산의 오류 처리에 대한 우아한 해결책입니다.</p>\n<ul>\n<li>하드웨어 수준에서 구현됨 (<code class=\"language-text\">ucomisd</code> 명령어)</li>\n<li>1985년부터 IEEE 754 표준의 일부</li>\n<li>연산을 통해 전파되며, 계산 마지막에 오류 감지를 허용함</li>\n<li><code class=\"language-text\">NaN !== NaN</code>은 <code class=\"language-text\">NaN</code> 감지를 가능하게 하는 의도된 설계임</li>\n<li><code class=\"language-text\">typeof NaN === \"number\"</code>는 <code class=\"language-text\">NaN</code>이 별도 타입이 아닌 숫자 시스템의 일부이기 때문임</li>\n</ul>\n<h2 id=\"references\" style=\"position:relative;\"><a href=\"#references\" aria-label=\"references permalink\" class=\"heading-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>References</h2>\n<ul>\n<li><a href=\"https://github.com/piotrzarycki/nan-from-scratch\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/piotrzarycki/nan-from-scratch</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/Pentium_FDIV_bug\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://en.wikipedia.org/wiki/Pentium_FDIV_bug</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/IEEE_754\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://en.wikipedia.org/wiki/IEEE_754</a></li>\n<li><a href=\"https://csapp.cs.cmu.edu/public/waside/waside-sse.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://csapp.cs.cmu.edu/public/waside/waside-sse.pdf</a></li>\n</ul>\n<blockquote>\n<p>🚀 한국어로 된 프런트엔드 아티클을 빠르게 받아보고 싶다면 <a href=\"https://kofearticle.substack.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Korean FE Article</a>을 구독해주세요!</p>\n</blockquote>","fields":{"slug":"/js-nan/"},"frontmatter":{"title":"(번역) 자바스크립트에서 `NaN !== NaN`인 이유 (그리고 그 뒤에 숨은 IEEE 754 이야기)","date":"2025-11-16","lastUpdated":"2025-11-16","description":null,"tags":["번역"]}},"previous":{"fields":{"slug":"/proud-128-kb/"},"frontmatter":{"title":"(번역) 내 생애 가장 자랑스러운 128킬로바이트"}},"next":null},"pageContext":{"id":"a14fa7ff-8d13-5839-8e1a-3b51ad334b04","previousPostId":"2ad58daf-4d7e-5ef8-8149-88dfe7435035","nextPostId":null,"ogImage":"public/og-image/js-nan/index.png"}},"staticQueryHashes":["2260143708","984448874"]}